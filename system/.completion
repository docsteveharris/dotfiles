# Shell completion
BREW_PREFIX=""
if command -v brew >/dev/null 2>&1; then
    BREW_PREFIX="$(brew --prefix 2>/dev/null || true)"
fi

# Bash

if is-executable brew; then
  # . "$BREW_PREFIX/share/bash-completion/bash_completion"
  [[ -r "/opt/homebrew/etc/profile.d/bash_completion.sh" ]] && . "/opt/homebrew/etc/profile.d/bash_completion.sh"
fi

# Dotfiles

_dotfiles_completions() {
  local cur="${COMP_WORDS[COMP_CWORD]}"
  COMPREPLY=( $(compgen -W 'clean dock duti edit help macos test update' -- $cur ) );
}

complete -o default -F _dotfiles_completions dot

# tmux

if is-executable brew; then
  . "$BREW_PREFIX/etc/bash_completion.d/tmux"
fi

# npm (https://docs.npmjs.com/cli/completion)

if is-executable npm; then
  . <(npm completion)
fi

# Git

if [ -n "$BREW_PREFIX" ] && [ -f "$BREW_PREFIX/etc/bash_completion.d/git-completion.bash" ]; then
    . "$BREW_PREFIX/etc/bash_completion.d/git-completion.bash"
elif [ -f /usr/share/bash-completion/completions/git ]; then
    . /usr/share/bash-completion/completions/git
elif [ -f /etc/bash_completion.d/git-completion.bash ]; then
    . /etc/bash_completion.d/git-completion.bash
fi

# pnpm

[ -f ~/.config/tabtab/bash/__tabtab.bash ] && . $HOME/.config/tabtab/bash/__tabtab.bash || true
